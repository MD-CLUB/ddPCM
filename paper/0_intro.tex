\section{Introduction}\label{sec:intro}
%Polarizable continuum solvation models (PCSM) represent a powerful tool in computational chemistry\cite{ReviewPCM_2005,Cramer:1999wt,Orozco_CR_Solvent00,Klamt:2011we,Mennucci:2012ct,honig1995cla,Roux:1999vp,Klamt_JCS_Cosmo,Chipman_JCP_SSVPE,Chipman_JCP_SSVPE2,Mennucci_JCP_IEF1,Mennucci_JMC_IEF2,Mennucci_JPCB_IEF3, Barone_JCPA_CPCM,Cossi_JCC_CPCM, Lipparini_JCP_VPCM,Lipparini_JCTC_VPCMSCF,Truhlar_JPCB_SMD}. Such models allow one to include environmental effects in the modeling of a molecular property in a cost-effective and almost black-box way and their extensions and developments include the coupling with the vast majority of the levels of theory used in quantum mechanical (QM) based computations and the development of analytical derivatives techniques to compute electric, magnetic, vibrational and mixed properties\cite{Mennucci_JPCL_PCM,Mennucci:2012ct,ReviewPCM_2005}. As a result, PCSM are nowadays available in most quantum chemistry codes and have become a standard tool, which can be successfully used by an extended community. 
%
%One of the key features of PCSM is their cost-effectiveness, which is however based on the assumption that a QM method can only be used to treat small to medium size systems and that the computational cost associated with the solution of the QM equations is much higher than the one due to PCSM themselves\cite{Scalmani_TCA_Iterative,Cammi_JCC_Inversion,Lipparini_JCP_VPCM,Lipparini_JPCL_ddCOSMO}. 
%In the last decade, the diffusion and refinement of linear scaling techniques and of hybrid QM/Classical strategies, mainly QM/MM methods, have seriously undermined such an assumption, as systems of several hundreds atoms can be nowadays routinely described with QM methods such as density functional theory and systems of several thousands of atoms can be modeled with QM/MM methods\cite{Warshel_JMB_QMMM,Warshel_JACS_QMMM,Gao_Science_QMMM,Bakowies_JPC_QMMM,Truhlar_TCA_QMMMReview,Thiel_ACIE_QMMMReview,
%Barone_Libro_QMMM}.
%In standard implementations, which are usually based on the Boundary Element Method\cite{MST,ReviewPCM_1994,ReviewPCM_2005,Scalmani_JCP_CSC,York_JPCA_CSC,
%Herbert_JCP_ISWIG} (BEM), PCSM require one to numerically solve a discretized integral equation, which in practical terms requires the solution of a linear system the size of which scales linearly, but with a large constant (a rough estimate would be 50--100), with respect to the number of atoms.  This is usually done using dense linear algebra techniques, such as LU decomposition\cite{Cammi_JCC_Inversion}, which require a computational effort proportional to the cube of the size of the linear system: such an operation can therefore rapidly become demanding when dealing with systems as large as the ones treated via QM/MM methods: other strategies become mandatory. Iterative techniques can be used to reduce the computational cost to the cost of several matrix-vector multiplications\cite{Scalmani_TCA_Iterative}, avoiding thus cubic operations; fast summation techniques, typically, the Fast Multipole Method (FMM)\cite{FMM}, can then be used to further reduce the cost of solving the PCSM linear equations to a number of floating point operations which is linear in the number of atoms. Nevertheless, the solution of the PCSM equations can still represent a formidable bottleneck for large systems\cite{Lipparini_JPCL_ddCOSMO}, especially, when repeated computations are required for statistical sampling purposes or time-dependent simulations.
%
%In a recent publication\cite{Cances_JCP_ddCOSMO}, we have introduced a completely different strategy to solve the PCSM equation for the Conductor-like Screening Model\cite{Klamt_JCS_Cosmo} (COSMO) in combination with Van der Waals molecular cavities. Such a strategy is based on a domain-decomposition approach\cite{DD_Method} and we refer to it as ddCOSMO\cite{Cances_JCP_ddCOSMO,Lipparini_JCTC_ddCOSMO,Lipparini_JPCL_ddCOSMO,Lipparini_JCP_ddCOSMO-QM}: the COSMO equation, in its differential form, is rewritten as a system of coupled linear differential equations, one per sphere, where only overlapping spheres are actually coupled. The differential equations on each sphere can then be recast as integral equations and solved very efficiently by using a (truncated) expansion in spherical harmonics\cite{Cances_JCP_ddCOSMO}. The discretization produces a block-sparse linear system\cite{Lipparini_JCTC_ddCOSMO}, where only the blocks corresponding to overlapping spheres are non-zero: this structure allows for a computational cost that scales linearly with respect to the number of atoms and is overall very small as compared to previous implementations: as far as two or three orders of magnitude are gained, as shown in a recent publication\cite{Lipparini_JPCL_ddCOSMO}.
%
%The aim of this article is to extend the ddCOSMO paradigm to the more general Polarizable Continuum Model\cite{ReviewPCM_2005} (PCM), and in particular to its most general formulation, IEF-PCM\cite{Mennucci_JCP_IEF1,Mennucci_JPCB_IEF3}, which treats the environment as a dielectric, and not as a perfect conductor: this is desirable not only for the sake of generality, but also because for low-polar solvents, the COSMO description is not physically appropriate. Unfortunately, from a mathematical point of view, PCM is much more complex than COSMO\cite{Cances_Librone_PCM} and a straightforward extension of the domain decomposition strategy we applied to the COSMO problem is not possible. In this paper, we propose an iterative algorithm to solve the PCM equation, called ddPCM, by decomposing the PCM problem in two steps, the second of which is a ddCOSMO computation. Our procedure is consistent with ddCOSMO in the sense that, for large enough dielectric constants, it gives the same results for the same discretization parameters; furthermore, it shares ddCOSMO's good properties of being systematically improvable and only controlled by a very limited amount of parameters. From a computational point of view, ddPCM remains substantially more expensive than ddCOSMO and, at the moment, requires a computation whose cost scales quadratically with the size of the system. Nevertheless, fast summation techniques can be used to overcome this quadratic bottleneck\cite{FMM} their application to ddPCM will be object of a forthcoming communication.

This paper is organized as follows. Section \ref{sec:review} reviews the ddPCM and ddCOSMO methods that we have previously developed. In Section \ref{sec:forces} we describe the derivation of the ddPCM forces and discuss their efficient implementation. Section \ref{sec:experiments} is devoted to numerical experiments. Finally, in Section \ref{sec:conclusions} we draw conclusions from the presented work and point to possible future directions of research.